{"version":3,"file":"index.esm.js","sources":["../src/api/CircleCIApi.ts","../src/route-refs.tsx","../src/plugin.ts","../src/util/time.ts","../src/components/BuildWithStepsPage/lib/ActionOutput/ActionOutput.tsx","../src/state/useAsyncPolling.ts","../src/constants.ts","../src/state/useBuilds.ts","../src/state/useBuildWithSteps.ts","../src/components/BuildWithStepsPage/BuildWithStepsPage.tsx","../src/components/BuildsPage/lib/CITable/CITable.tsx","../src/components/BuildsPage/lib/Builds/Builds.tsx","../src/components/BuildsPage/BuildsPage.tsx","../src/components/Router.tsx"],"sourcesContent":["/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  CircleCIOptions,\n  getMe,\n  getBuildSummaries,\n  getFullBuild,\n  postBuildActions,\n  BuildAction,\n  BuildWithSteps,\n  BuildStepAction,\n  BuildSummary,\n  GitType,\n} from 'circleci-api';\nimport { createApiRef, DiscoveryApi } from '@backstage/core-plugin-api';\n\n/** @public */\nexport { GitType };\n\n/** @public */\nexport type { BuildWithSteps, BuildStepAction, BuildSummary };\n\n/** @public */\nexport const circleCIApiRef = createApiRef<CircleCIApi>({\n  id: 'plugin.circleci.service',\n});\n\nconst DEFAULT_PROXY_PATH = '/circleci/api';\n\n/** @public */\nexport class CircleCIApi {\n  private readonly discoveryApi: DiscoveryApi;\n  private readonly proxyPath: string;\n\n  constructor(options: {\n    discoveryApi: DiscoveryApi;\n    /**\n     * Path to use for requests via the proxy, defaults to /circleci/api\n     */\n    proxyPath?: string;\n  }) {\n    this.discoveryApi = options.discoveryApi;\n    this.proxyPath = options.proxyPath ?? DEFAULT_PROXY_PATH;\n  }\n\n  async retry(buildNumber: number, options: Partial<CircleCIOptions>) {\n    return postBuildActions('', buildNumber, BuildAction.RETRY, {\n      circleHost: await this.getApiUrl(),\n      ...options.vcs,\n    });\n  }\n\n  async getBuilds(\n    pagination: { limit: number; offset: number },\n    options: Partial<CircleCIOptions>,\n  ) {\n    const { limit = 10, offset = 0 } = pagination;\n    return getBuildSummaries('', {\n      options: {\n        limit,\n        offset,\n      },\n      vcs: {},\n      circleHost: await this.getApiUrl(),\n      ...options,\n    });\n  }\n\n  async getUser(options: Partial<CircleCIOptions>) {\n    return getMe('', { circleHost: await this.getApiUrl(), ...options });\n  }\n\n  async getBuild(buildNumber: number, options: Partial<CircleCIOptions>) {\n    return getFullBuild('', buildNumber, {\n      circleHost: await this.getApiUrl(),\n      ...options.vcs,\n    });\n  }\n\n  async getUrl(url: string): Promise<unknown> {\n    return fetch(url).then(res => res.json());\n  }\n\n  private async getApiUrl() {\n    const proxyUrl = await this.discoveryApi.getBaseUrl('proxy');\n    return proxyUrl + this.proxyPath;\n  }\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { createRouteRef, createSubRouteRef } from '@backstage/core-plugin-api';\n\n/** @public */\nexport const circleCIRouteRef = createRouteRef({\n  id: 'circle-ci',\n});\n\n/** @public */\nexport const circleCIBuildRouteRef = createSubRouteRef({\n  id: 'circle-ci/build',\n  parent: circleCIRouteRef,\n  path: '/:buildId',\n});\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { circleCIApiRef, CircleCIApi } from './api';\nimport { circleCIRouteRef } from './route-refs';\nimport {\n  createPlugin,\n  createApiFactory,\n  discoveryApiRef,\n  createRoutableExtension,\n} from '@backstage/core-plugin-api';\n\n/** @public */\nexport const circleCIPlugin = createPlugin({\n  id: 'circleci',\n  apis: [\n    createApiFactory({\n      api: circleCIApiRef,\n      deps: { discoveryApi: discoveryApiRef },\n      factory: ({ discoveryApi }) => new CircleCIApi({ discoveryApi }),\n    }),\n  ],\n});\n\n/** @public */\nexport const EntityCircleCIContent = circleCIPlugin.provide(\n  createRoutableExtension({\n    name: 'EntityCircleCIContent',\n    component: () => import('./components/Router').then(m => m.Router),\n    mountPoint: circleCIRouteRef,\n  }),\n);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { DateTime, Interval } from 'luxon';\nimport humanizeDuration from 'humanize-duration';\n\nexport function relativeTimeTo(dateTimeISOString?: string) {\n  return dateTimeISOString\n    ? DateTime.fromISO(dateTimeISOString).toRelative()\n    : '';\n}\n\nexport function durationHumanized(\n  startDateTimeISOString?: string,\n  endDateTimeISOString?: string,\n): string {\n  if (!startDateTimeISOString || !endDateTimeISOString) {\n    return '';\n  }\n\n  const startDateTime = DateTime.fromISO(startDateTimeISOString);\n  const endDateTime = DateTime.fromISO(endDateTimeISOString);\n  const duration = Interval.fromDateTimes(\n    startDateTime,\n    endDateTime,\n  ).toDuration();\n\n  return humanizeDuration(duration.as('milliseconds'), {\n    largest: 1,\n  });\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { LogViewer } from '@backstage/core-components';\nimport {\n  Accordion,\n  AccordionDetails,\n  AccordionSummary,\n  Typography,\n} from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport { BuildStepAction } from 'circleci-api';\nimport React, { useEffect, useState } from 'react';\nimport { durationHumanized } from '../../../../util';\n\nconst useStyles = makeStyles({\n  accordionDetails: {\n    padding: 0,\n  },\n  button: {\n    order: -1,\n    marginRight: 0,\n    marginLeft: '-20px',\n  },\n});\n\nexport const ActionOutput = ({\n  url,\n  name,\n  className,\n  action,\n}: {\n  url: string;\n  name: string;\n  className?: string;\n  action: BuildStepAction;\n}) => {\n  const classes = useStyles();\n\n  const [messages, setMessages] = useState([]);\n  useEffect(() => {\n    fetch(url)\n      .then(res => res.json())\n      .then(actionOutput => {\n        if (typeof actionOutput !== 'undefined') {\n          setMessages(\n            actionOutput.map(({ message }: { message: string }) => message),\n          );\n        }\n      }); // handle error\n  }, [url]);\n\n  const timeElapsed = durationHumanized(action.start_time, action.end_time);\n\n  return (\n    <Accordion TransitionProps={{ unmountOnExit: true }} className={className}>\n      <AccordionSummary\n        expandIcon={<ExpandMoreIcon />}\n        aria-controls={`panel-${name}-content`}\n        id={`panel-${name}-header`}\n        IconButtonProps={{\n          className: classes.button,\n        }}\n      >\n        <Typography variant=\"button\">\n          {name} ({timeElapsed})\n        </Typography>\n      </AccordionSummary>\n      <AccordionDetails className={classes.accordionDetails}>\n        {messages.length === 0 ? (\n          'Nothing here...'\n        ) : (\n          <div style={{ height: '20vh', width: '100%' }}>\n            <LogViewer text={messages.join('\\n')} />\n          </div>\n        )}\n      </AccordionDetails>\n    </Accordion>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useRef } from 'react';\n\nexport const useAsyncPolling = (\n  pollingFn: () => Promise<any>,\n  interval: number,\n) => {\n  const isPolling = useRef<boolean>(false);\n  const startPolling = async () => {\n    if (isPolling.current === true) return;\n    isPolling.current = true;\n\n    while (isPolling.current === true) {\n      await pollingFn();\n      await new Promise(resolve => setTimeout(resolve, interval));\n    }\n  };\n\n  const stopPolling = () => {\n    isPolling.current = false;\n  };\n  return { startPolling, stopPolling };\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @public */\nexport const CIRCLECI_ANNOTATION = 'circleci.com/project-slug';\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { useEntity } from '@backstage/plugin-catalog-react';\nimport { BuildSummary, GitType } from 'circleci-api';\nimport { getOr } from 'lodash/fp';\nimport { useCallback, useEffect, useState } from 'react';\nimport useAsyncRetry from 'react-use/lib/useAsyncRetry';\nimport { circleCIApiRef } from '../api';\nimport type { CITableBuildInfo } from '../components/BuildsPage/lib/CITable';\nimport { CIRCLECI_ANNOTATION } from '../constants';\nimport { ErrorApiError, errorApiRef, useApi } from '@backstage/core-plugin-api'\n\nconst makeReadableStatus = (status: string | undefined) => {\n  if (!status) return '';\n  return (\n    {\n      retried: 'Retried',\n      canceled: 'Canceled',\n      infrastructure_fail: 'Infra fail',\n      timedout: 'Timedout',\n      not_run: 'Not run',\n      running: 'Running',\n      failed: 'Failed',\n      queued: 'Queued',\n      scheduled: 'Scheduled',\n      not_running: 'Not running',\n      no_tests: 'No tests',\n      fixed: 'Fixed',\n      success: 'Success',\n    } as Record<string, string>\n  )[status];\n};\n\nconst mapWorkflowDetails = (buildData: BuildSummary) => {\n  // Workflows should be an object: fixed in https://github.com/worldturtlemedia/circleci-api/pull/787\n  const { workflows } = (buildData as any) ?? {};\n\n  return {\n    id: workflows?.workflow_id,\n    url: `${buildData.build_url}/workflows/${workflows?.workflow_id}`,\n    jobName: workflows?.job_name,\n    name: workflows?.workflow_name,\n  };\n};\n\nconst mapSourceDetails = (buildData: BuildSummary) => {\n  const commitDetails = getOr({}, 'all_commit_details[0]', buildData);\n\n  return {\n    branchName: String(buildData.branch),\n    commit: {\n      hash: String(buildData.vcs_revision),\n      shortHash: String(buildData.vcs_revision).slice(0, 7),\n      committerName: buildData.committer_name,\n      url: commitDetails.commit_url,\n    },\n  };\n};\n\nconst mapUser = (buildData: BuildSummary) => ({\n  isUser: buildData?.user?.is_user || false,\n  login: buildData?.user?.login || 'none',\n  name: (buildData?.user as any)?.name,\n  avatarUrl: (buildData?.user as any)?.avatar_url,\n});\n\nexport const transform = (\n  buildsData: BuildSummary[],\n  restartBuild: { (buildId: number): Promise<void> },\n): CITableBuildInfo[] => {\n  return buildsData.map(buildData => {\n    const tableBuildInfo: CITableBuildInfo = {\n      id: String(buildData.build_num),\n      buildName: buildData.subject\n        ? buildData.subject +\n          (buildData.retry_of ? ` (retry of #${buildData.retry_of})` : '')\n        : '',\n      startTime: buildData.start_time,\n      stopTime: buildData.stop_time,\n      onRestartClick: () =>\n        typeof buildData.build_num !== 'undefined' &&\n        restartBuild(buildData.build_num),\n      source: mapSourceDetails(buildData),\n      workflow: mapWorkflowDetails(buildData),\n      user: mapUser(buildData),\n      status: makeReadableStatus(buildData.status),\n      buildUrl: buildData.build_url,\n    };\n    return tableBuildInfo;\n  });\n};\n\nexport const useProjectSlugFromEntity = () => {\n  const { entity } = useEntity();\n  const [vcs, owner, repo] = (\n    entity.metadata.annotations?.[CIRCLECI_ANNOTATION] ?? ''\n  ).split('/');\n  return { vcs, owner, repo };\n};\n\nexport function mapVcsType(vcs: string): GitType {\n  switch (vcs) {\n    case 'gh':\n    case 'github':\n      return GitType.GITHUB;\n    default:\n      return GitType.BITBUCKET;\n  }\n}\n\nexport function useBuilds() {\n  const { repo, owner, vcs } = useProjectSlugFromEntity();\n  const api = useApi(circleCIApiRef);\n  const errorApi = useApi(errorApiRef);\n\n  const [total, setTotal] = useState(0);\n  const [page, setPage] = useState(0);\n  const [pageSize, setPageSize] = useState(10);\n\n  const getBuilds = useCallback(\n    async ({ limit, offset }: { limit: number; offset: number }) => {\n      if (owner === '' || repo === '' || vcs === '') {\n        return Promise.reject('No credentials provided');\n      }\n\n      try {\n        return await api.getBuilds(\n          { limit, offset },\n          {\n            vcs: {\n              owner: owner,\n              repo: repo,\n              type: mapVcsType(vcs),\n            },\n          },\n        );\n      } catch (e) {\n        errorApi.post(e as ErrorApiError);\n        return Promise.reject(e);\n      }\n    },\n    [repo, owner, vcs, api, errorApi],\n  );\n\n  const restartBuild = async (buildId: number) => {\n    try {\n      await api.retry(buildId, {\n        vcs: {\n          owner: owner,\n          repo: repo,\n          type: mapVcsType(vcs),\n        },\n      });\n    } catch (e) {\n      errorApi.post(e as ErrorApiError);\n    }\n  };\n\n  useEffect(() => {\n    getBuilds({ limit: 1, offset: 0 }).then(b => setTotal(b?.[0].build_num!));\n  }, [repo, getBuilds]);\n\n  const { loading, value, retry } = useAsyncRetry(\n    () =>\n      getBuilds({\n        offset: page * pageSize,\n        limit: pageSize,\n      }).then(builds => transform(builds ?? [], restartBuild)),\n    [page, pageSize, getBuilds],\n  );\n\n  const projectName = `${owner}/${repo}`;\n  return [\n    {\n      page,\n      pageSize,\n      loading,\n      value,\n      projectName,\n      total,\n    },\n    {\n      getBuilds,\n      setPage,\n      setPageSize,\n      restartBuild,\n      retry,\n    },\n  ] as const;\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport { useCallback, useMemo } from 'react';\nimport useAsyncRetry from 'react-use/lib/useAsyncRetry';\nimport { circleCIApiRef } from '../api';\nimport { useAsyncPolling } from './useAsyncPolling';\nimport { useProjectSlugFromEntity, mapVcsType } from './useBuilds';\nimport { ErrorApiError, errorApiRef, useApi } from '@backstage/core-plugin-api'\n\nconst INTERVAL_AMOUNT = 1500;\nexport function useBuildWithSteps(buildId: number) {\n  const { vcs, repo, owner } = useProjectSlugFromEntity();\n  const api = useApi(circleCIApiRef);\n  const errorApi = useApi(errorApiRef);\n\n  const vcsOption = useMemo(\n    () => ({\n      owner: owner,\n      repo: repo,\n      type: mapVcsType(vcs),\n    }),\n    [owner, repo, vcs],\n  );\n\n  const getBuildWithSteps = useCallback(async () => {\n    if (owner === '' || repo === '' || vcs === '') {\n      return Promise.reject('No credentials provided');\n    }\n\n    try {\n      const options = {\n        vcs: vcsOption,\n      };\n      const build = await api.getBuild(buildId, options);\n      return Promise.resolve(build);\n    } catch (e) {\n      errorApi.post(e as ErrorApiError);\n      return Promise.reject(e);\n    }\n  }, [vcsOption, buildId, api, errorApi]); // eslint-disable-line react-hooks/exhaustive-deps\n\n  const restartBuild = async () => {\n    try {\n      await api.retry(buildId, {\n        vcs: vcsOption,\n      });\n    } catch (e) {\n      errorApi.post(e as ErrorApiError);\n    }\n  };\n\n  const { loading, value, retry } = useAsyncRetry(\n    () => getBuildWithSteps(),\n    [getBuildWithSteps],\n  );\n\n  const { startPolling, stopPolling } = useAsyncPolling(\n    getBuildWithSteps,\n    INTERVAL_AMOUNT,\n  );\n\n  return [\n    { loading, value, retry },\n    {\n      restartBuild,\n      getBuildWithSteps,\n      startPolling,\n      stopPolling,\n    },\n  ] as const;\n}\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React, { useEffect } from 'react';\nimport { useParams } from 'react-router-dom';\nimport { BuildWithSteps, BuildStepAction } from '../../api';\nimport { Grid, Box, Typography } from '@material-ui/core';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { ActionOutput } from './lib/ActionOutput/ActionOutput';\nimport LaunchIcon from '@material-ui/icons/Launch';\nimport { useBuildWithSteps } from '../../state/useBuildWithSteps';\nimport {\n  Breadcrumbs,\n  LinkButton,\n  InfoCard,\n  Progress,\n  Link,\n} from '@backstage/core-components';\n\nconst BuildName = ({ build }: { build?: BuildWithSteps }) => (\n  <Box display=\"flex\" alignItems=\"center\">\n    #{build?.build_num} - {build?.subject}\n    <LinkButton to={build?.build_url || '#'}>\n      <LaunchIcon />\n    </LinkButton>\n  </Box>\n);\n\nconst useStyles = makeStyles(theme => ({\n  neutral: {},\n  failed: {\n    position: 'relative',\n    '&:after': {\n      pointerEvents: 'none',\n      content: '\"\"',\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      left: 0,\n      bottom: 0,\n      boxShadow: `inset 4px 0px 0px ${theme.palette.error.main}`,\n    },\n  },\n  running: {\n    position: 'relative',\n    '&:after': {\n      pointerEvents: 'none',\n      content: '\"\"',\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      left: 0,\n      bottom: 0,\n      boxShadow: `inset 4px 0px 0px ${theme.palette.info.main}`,\n    },\n  },\n  cardContent: {\n    backgroundColor: theme.palette.background.default,\n  },\n  success: {\n    position: 'relative',\n    '&:after': {\n      pointerEvents: 'none',\n      content: '\"\"',\n      position: 'absolute',\n      top: 0,\n      right: 0,\n      left: 0,\n      bottom: 0,\n      boxShadow: `inset 4px 0px 0px ${theme.palette.success.main}`,\n    },\n  },\n}));\n\nconst pickClassName = (\n  classes: ReturnType<typeof useStyles>,\n  build: BuildWithSteps = {} as BuildWithSteps,\n) => {\n  if (build.failed) return classes.failed;\n  if (['running', 'queued'].includes(build.status!)) return classes.running;\n  if (build.status === 'success') return classes.success;\n\n  return classes.neutral;\n};\n\nconst ActionsList = ({\n  actions,\n}: {\n  actions: BuildStepAction[];\n  name: string;\n}) => {\n  const classes = useStyles();\n  return (\n    <>\n      {actions.map((action: BuildStepAction) => (\n        <ActionOutput\n          className={action.failed ? classes.failed : classes.success}\n          action={action}\n          name={action.name}\n          url={action.output_url || ''}\n        />\n      ))}\n    </>\n  );\n};\n\nconst BuildsList = ({ build }: { build?: BuildWithSteps }) => (\n  <Box>\n    {build &&\n      build.steps &&\n      build.steps.map(\n        ({ name, actions }: { name: string; actions: BuildStepAction[] }) => (\n          <ActionsList key={name} name={name} actions={actions} />\n        ),\n      )}\n  </Box>\n);\n\nexport const BuildWithStepsPage = () => {\n  const { buildId = '' } = useParams();\n  const classes = useStyles();\n  const [{ loading, value }, { startPolling, stopPolling }] = useBuildWithSteps(\n    parseInt(buildId, 10),\n  );\n\n  useEffect(() => {\n    startPolling();\n    return () => stopPolling();\n  }, [buildId, startPolling, stopPolling]);\n\n  return (\n    <>\n      <Box mb={3}>\n        <Breadcrumbs aria-label=\"breadcrumb\">\n          <Link to=\"..\">All builds</Link>\n          <Typography>Build details</Typography>\n        </Breadcrumbs>\n      </Box>\n      <Grid container spacing={3} direction=\"column\">\n        <Grid item>\n          <InfoCard\n            className={pickClassName(classes, value)}\n            title={<BuildName build={value} />}\n            cardClassName={classes.cardContent}\n          >\n            {loading ? <Progress /> : <BuildsList build={value} />}\n          </InfoCard>\n        </Grid>\n      </Grid>\n    </>\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport {\n  Avatar,\n  Typography,\n  Box,\n  IconButton,\n  makeStyles,\n  Tooltip,\n} from '@material-ui/core';\nimport RetryIcon from '@material-ui/icons/Replay';\nimport GitHubIcon from '@material-ui/icons/GitHub';\nimport LaunchIcon from '@material-ui/icons/Launch';\nimport { durationHumanized, relativeTimeTo } from '../../../../util';\nimport {\n  StatusError,\n  StatusWarning,\n  StatusOK,\n  StatusPending,\n  StatusRunning,\n  Table,\n  TableColumn,\n  Link,\n} from '@backstage/core-components';\n\nexport type CITableBuildInfo = {\n  id: string;\n  buildName: string;\n  buildUrl?: string;\n  startTime?: string;\n  stopTime?: string;\n  source: {\n    branchName: string;\n    commit: {\n      hash: string;\n      shortHash: string;\n      url: string;\n      committerName?: string;\n    };\n  };\n  status: string;\n  tests?: {\n    total: number;\n    passed: number;\n    skipped: number;\n    failed: number;\n    testUrl: string; // fixme better name\n  };\n  workflow: {\n    id: string;\n    url: string;\n    name?: string;\n    jobName?: string;\n  };\n  user: {\n    isUser: boolean;\n    login: string;\n    name?: string;\n    avatarUrl?: string;\n  };\n  onRestartClick: () => void;\n};\n\n// retried, canceled, infrastructure_fail, timedout, not_run, running, failed, queued, scheduled, not_running, no_tests, fixed, success\nconst getStatusComponent = (status: string | undefined = '') => {\n  switch (status.toLocaleLowerCase('en-US')) {\n    case 'queued':\n    case 'scheduled':\n      return <StatusPending />;\n    case 'running':\n      return <StatusRunning />;\n    case 'failed':\n      return <StatusError />;\n    case 'success':\n      return <StatusOK />;\n    case 'canceled':\n    default:\n      return <StatusWarning />;\n  }\n};\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    '& > *': {\n      margin: theme.spacing(1),\n      verticalAlign: 'center',\n    },\n  },\n  small: {\n    width: theme.spacing(3),\n    height: theme.spacing(3),\n  },\n}));\n\nconst SourceInfo = ({ build }: { build: CITableBuildInfo }) => {\n  const classes = useStyles();\n  const { user, source } = build;\n\n  return (\n    <Box display=\"flex\" alignItems=\"center\" className={classes.root}>\n      <Tooltip title={user.name ?? user.login}>\n        <Avatar\n          alt={user.name}\n          src={user.avatarUrl}\n          className={classes.small}\n        />\n      </Tooltip>\n      <Box>\n        <Typography variant=\"button\">{source?.branchName}</Typography>\n        <Typography variant=\"body1\">\n          {source?.commit?.url !== undefined ? (\n            <Link to={source?.commit?.url}>{source?.commit.shortHash}</Link>\n          ) : (\n            source?.commit.shortHash\n          )}\n        </Typography>\n      </Box>\n    </Box>\n  );\n};\n\nconst generatedColumns: TableColumn[] = [\n  {\n    title: 'ID',\n    field: 'id',\n    type: 'numeric',\n    width: '80px',\n  },\n  {\n    title: 'Build',\n    field: 'buildName',\n    highlight: true,\n    width: '20%',\n    render: (row: Partial<CITableBuildInfo>) => {\n      return row.buildName ? row.buildName : row?.workflow?.name;\n    },\n  },\n  {\n    title: 'Job',\n    field: 'buildName',\n    highlight: true,\n    render: (row: Partial<CITableBuildInfo>) => (\n      <Link to={row?.buildUrl ?? ''}>\n        <Box display=\"flex\" alignItems=\"center\">\n          <LaunchIcon fontSize=\"small\" color=\"disabled\" />\n          <Box mr={1} />\n          {row?.workflow?.jobName}\n        </Box>\n      </Link>\n    ),\n  },\n  {\n    title: 'Source',\n    field: 'source.commit.hash',\n    highlight: true,\n    render: (row: Partial<CITableBuildInfo>) => (\n      <SourceInfo build={row as any} />\n    ),\n  },\n  {\n    title: 'Status',\n    field: 'status',\n    render: (row: Partial<CITableBuildInfo>) => (\n      <Box display=\"flex\" alignItems=\"center\">\n        {getStatusComponent(row.status)}\n        <Box mr={1} />\n        <Typography variant=\"button\">{row.status}</Typography>\n      </Box>\n    ),\n  },\n  {\n    title: 'Time',\n    field: 'startTime',\n    render: (row: Partial<CITableBuildInfo>) =>\n      row?.startTime ? (\n        <>\n          <Typography variant=\"body2\">\n            run {relativeTimeTo(row?.startTime)}\n          </Typography>\n          <Typography variant=\"body2\">\n            {row?.stopTime\n              ? `took ${durationHumanized(row?.startTime, row?.stopTime)}`\n              : ''}\n          </Typography>\n        </>\n      ) : null,\n  },\n  {\n    title: 'Workflow',\n    field: 'workflow.name',\n    highlight: true,\n    render: (row: Partial<CITableBuildInfo>) => (\n      <Link\n        to={`https://app.circleci.com/pipelines/workflows/${row?.workflow?.id}`}\n      >\n        <Box display=\"flex\" alignItems=\"center\">\n          <LaunchIcon fontSize=\"small\" color=\"disabled\" />\n          <Box mr={1} />\n          {row?.workflow?.name}\n        </Box>\n      </Link>\n    ),\n  },\n  {\n    title: 'Actions',\n    width: '10%',\n    render: (row: Partial<CITableBuildInfo>) => (\n      <IconButton onClick={row.onRestartClick}>\n        <RetryIcon />\n      </IconButton>\n    ),\n  },\n];\n\ntype Props = {\n  loading: boolean;\n  retry: () => void;\n  builds: CITableBuildInfo[];\n  projectName: string;\n  page: number;\n  onChangePage: (page: number) => void;\n  total: number;\n  pageSize: number;\n  onChangePageSize: (pageSize: number) => void;\n};\n\nexport const CITable = ({\n  projectName,\n  loading,\n  pageSize,\n  page,\n  retry,\n  builds,\n  onChangePage,\n  onChangePageSize,\n  total,\n}: Props) => {\n  return (\n    <Table\n      isLoading={loading}\n      options={{\n        paging: true,\n        pageSize,\n        padding: 'dense',\n        pageSizeOptions: [10, 20, 50],\n      }}\n      totalCount={total}\n      page={page}\n      actions={[\n        {\n          icon: () => <RetryIcon />,\n          tooltip: 'Refresh Data',\n          isFreeAction: true,\n          onClick: () => retry(),\n        },\n      ]}\n      data={builds}\n      onPageChange={onChangePage}\n      onRowsPerPageChange={onChangePageSize}\n      title={\n        <Box display=\"flex\" alignItems=\"center\">\n          <GitHubIcon />\n          <Box mr={1} />\n          <Typography variant=\"h6\">{projectName}</Typography>\n        </Box>\n      }\n      columns={generatedColumns}\n    />\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport { CITable } from '../CITable';\nimport { useBuilds } from '../../../../state';\n\nexport const Builds = () => {\n  const [\n    { total, loading, value, projectName, page, pageSize },\n    { setPage, retry, setPageSize },\n  ] = useBuilds();\n  return (\n    <CITable\n      total={total}\n      loading={loading}\n      retry={retry}\n      builds={value ?? []}\n      projectName={projectName}\n      page={page}\n      onChangePage={setPage}\n      pageSize={pageSize}\n      onChangePageSize={setPageSize}\n    />\n  );\n};\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport React from 'react';\nimport { Builds } from './lib/Builds';\nimport { Grid } from '@material-ui/core';\n\nexport const BuildsPage = () => (\n  <Grid container spacing={3} direction=\"column\">\n    <Grid item>\n      <Builds />\n    </Grid>\n  </Grid>\n);\n","/*\n * Copyright 2020 The Backstage Authors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport React from 'react';\nimport { Routes, Route } from 'react-router-dom';\nimport { circleCIBuildRouteRef } from '../route-refs';\nimport { BuildWithStepsPage } from './BuildWithStepsPage/';\nimport { BuildsPage } from './BuildsPage';\nimport { CIRCLECI_ANNOTATION } from '../constants';\nimport { Entity } from '@backstage/catalog-model';\nimport { useEntity } from '@backstage/plugin-catalog-react';\nimport { MissingAnnotationEmptyState } from '@backstage/core-components';\n\n/** @public */\nexport const isCircleCIAvailable = (entity: Entity) =>\n  Boolean(entity.metadata.annotations?.[CIRCLECI_ANNOTATION]);\n\n/** @public */\nexport const Router = () => {\n  const { entity } = useEntity();\n\n  if (!isCircleCIAvailable(entity)) {\n    return <MissingAnnotationEmptyState annotation={CIRCLECI_ANNOTATION} />;\n  }\n\n  return (\n    <Routes>\n      <Route path=\"/\" element={<BuildsPage />} />\n      <Route\n        path={`${circleCIBuildRouteRef.path}`}\n        element={<BuildWithStepsPage />}\n      />\n    </Routes>\n  );\n};\n"],"names":["useStyles","makeStyles"],"mappings":"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"}